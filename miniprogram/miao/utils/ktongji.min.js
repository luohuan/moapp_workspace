var ktj={j:"https://alog.kuaiyq.com/a/v1/track",o:"ktj",a:"2.0.0",r:"",h:"",d:"",_:"",l:"",g:"",w:"",m:"",x:"",I:"",y:"",A:"",networkType:"",T:{},P:{},userInfo:{},S:null,U:null,D:null,H:"",O:0,L:0,K:!1,M:["_ktj_apperror","_ktj_pageload","_ktj_pageshow","_ktj_pageexit"],init:function(t){this.F=t,this.x=this.b(),this.S=Date.now(),this.C(),this.J(),this.N()},disableAntiFraudDetection:function(){this.K=!0},R:function(){return this.h},C:function(){if(void 0!=wx.navigateToMiniProgram){var t=wx.navigateToMiniProgram;Object.defineProperty(wx,"navigateToMiniProgram",{value:function(){var n=arguments[0];return ktj.q(n,"success",function(){var t=ktj.V({e:"_ktj_tomp",p:{ai:n.appId,pt:n.path,ed:n.extraData},u:ktj.userInfo});ktj.B(t)}),t.apply(wx,arguments)},writable:!1})}},N:function(){var t=this,n=App;App=function(k){t.q(k,"onLaunch",t.G),t.q(k,"onShow",t.Q),t.q(k,"onHide",t.X),t.q(k,"onError",t.Y),n(k)};var k=Page;Page=function(n){t.q(n,"onLoad",t.z),t.q(n,"onShow",t.W),t.q(n,"onHide",t.Z),t.q(n,"onUnload",t.Z),void 0!==n.onShareAppMessage&&t.$(n,"onShareAppMessage",t.tt),k(n)}},q:function(t,n,k){if(t[n]){var i=t[n];t[n]=function(t){k.call(this,t),i.call(this,t)}}else t[n]=function(t){k.call(this,t)}},$:function(t,n,k){if(t[n]){var i=t[n];t[n]=function(t){var n=i.call(this,t);return k.call(this,t,n),n}}else t[n]=function(t){k.call(this,t)}},G:function(t){if(this.ktongji=ktj,ktj.H="launch",ktj.T=t,ktj.I=t.path,ktj.nt(t),t.referrerInfo&&t.referrerInfo.extraData){var n=t.referrerInfo.extraData;t.referrerInfo.extraData="string"==typeof n?JSON.parse(n):n}if(ktj.d=ktj.kt("ktj_src"),""==ktj.d){if(void 0!==t.query.ktj_src)ktj.d=t.query.ktj_src;else if(t.referrerInfo){n=t.referrerInfo.extraData;t.referrerInfo.extraData&&n.ktj_src?ktj.d=n.ktj_src:t.referrerInfo.appId&&(ktj.d=t.referrerInfo.appId)}""!=ktj.d&&ktj.it("ktj_src",ktj.d)}else t.query.ktj_fsrc&&(ktj.d=t.query.ktj_src,ktj.it("ktj_src",ktj.d));var k=function(){wx.getNetworkType({success:function(t){ktj.networkType=t.networkType},complete:i})},i=function(t){wx.getSetting&&wx.getSetting({success:function(t){t.authSetting["scope.userInfo"]?wx.getUserInfo({withCredentials:!1,fail:function(){},success:function(t){ktj.et(t.userInfo),ktj.jt()}}):ktj.jt()}})};wx.getSystemInfo({success:function(t){ktj.P.dv=void 0===t.SDKVersion?"1.0.0":t.SDKVersion,ktj.P.md=t.model,ktj.P.po=t.pixelRatio,ktj.P.ww=t.windowWidth,ktj.P.wh=t.windowHeight,ktj.P.lg=t.language,ktj.P.wv=t.version,ktj.P.sv=t.system,ktj.P.pf=t.platform},complete:k})},Q:function(t){ktj.H="appshow",ktj.U=Date.now();var n=ktj.V({e:"_ktj_appshow",p:ktj.ot(t)});ktj.B(n)},X:function(){if(ktj.L=Date.now(),"shareapp"!=ktj.H){var t=ktj.V({e:"_ktj_apphide",p:{du:ktj.L-ktj.S,sdu:ktj.L-ktj.U}});ktj.B(t)}ktj.H="apphide"},Y:function(t){var n=ktj.V({e:"_ktj_apperror",p:{em:t},u:ktj.userInfo,si:ktj.P});ktj.B(n)},z:function(t){ktj.y=this.route;var n=ktj.V({pp:ktj.A,e:"_ktj_pageload",ep:t});ktj.B(n)},W:function(){this.at=Date.now(),ktj.y=this.route;var t=ktj.V({pp:ktj.A,e:"_ktj_pageshow"});ktj.B(t)},Z:function(){ktj.A=ktj.y;var t=ktj.V({e:"_ktj_pageexit",p:{du:Date.now()-this.at}});ktj.B(t)},tt:function(t,n){if(ktj.H="shareapp",ktj.O=Date.now(),void 0===n)return;var k="";k=""===ktj.d?ktj.h:ktj.d;const i=ktj.b();-1!=n.path.indexOf("?")?n.path+="&ktj_src="+k+"&ktj_fuid="+ktj.h+"&ktj_srid="+i:n.path+="?ktj_src="+k+"&ktj_fuid="+ktj.h+"&ktj_srid="+i;var e=ktj.V({e:"_ktj_shareapp",p:{c:k,srid:i}});return ktj.B(e),n},J:function(){this.h||(this.h=ktj.kt("ktj_uid"),this.h||(ktj.h=ktj.b(),ktj.it("ktj_uid",ktj.h)))},trackNavigateToMiniProgram:function(t){var n=ktj.V({e:"_ktj_tomp",p:{ai:t.appId,pt:t.path,ed:t.extraData},u:ktj.userInfo});void 0!==t.openId&&(n.p.oi=t.openId),ktj.B(n)},jt:function(){var t=ktj.V({lp:ktj.I,e:"_ktj_launch",p:ktj.ot(ktj.T),u:ktj.userInfo,si:ktj.P});this.B(t)},V:function(t){var n={k:ktj.F,t:ktj.o,v:ktj.a,s:ktj.x,i:ktj.h,cp:ktj.y,n:ktj.networkType,ts:Date.now()};return""!=ktj.d&&(n.c=ktj.d),""!=ktj.g&&(n.f=ktj.g),""!=ktj.l&&(n.fo=ktj.l),""!=ktj._&&(n.fu=ktj._),""!=ktj.w&&(n.srid=ktj.w),Object.assign(t,n)},B:function(t){if(!this.K||!this.M.includes(t.e)){var n=0,k=function(){n+=1,t.tc=n,wx.request({url:ktj.j,header:{"X-KYQ-SDK":"KTJ "+ktj.a+" "+ktj.F,"Content-Type":"application/json"},data:t,method:"POST",success:function(){},fail:function(){n<2&&(t.tc=n,k())}})};k()}},et:function(t){this.userInfo.nn=t.nickName,this.userInfo.gd=t.gender,this.userInfo.lg=t.language,this.userInfo.cy=t.city,this.userInfo.pe=t.province,this.userInfo.ct=t.country,this.userInfo.au=t.avatarUrl},nt:function(t){ktj.g=ktj.kt("ktj_fuid"),ktj.w=ktj.kt("ktj_srid"),t.query.openid&&(ktj.l=t.query.openid),t.query.ktj_uid&&(ktj._=t.query.ktj_uid),""==ktj.g&&(void 0!==t.query.ktj_fuid&&t.query.ktj_fuid!=ktj._&&(ktj.g=t.query.ktj_fuid),""!=ktj.g&&ktj.it("ktj_fuid",ktj.g)),""==ktj.w&&(void 0!==t.query.ktj_srid&&(ktj.w=t.query.ktj_srid),""!=ktj.w&&ktj.it("ktj_srid",ktj.w))},ot:function(t){var n={pt:t.path,qy:t.query,sn:t.scene};return t.shareTicket&&(n.st=t.shareTicket),t.referrerInfo&&(n.ri={ai:t.referrerInfo.appId,ed:t.referrerInfo.extraData}),n},kt:function(t){var n="";try{n=wx.getStorageSync(t)}catch(t){}return n},it:function(t,n){try{wx.setStorageSync(t,n)}catch(k){wx.setStorage({key:t,data:n,success:function(){},fail:function(){}})}},b:function(){return""+(new Date).getTime()+Math.floor(1e8*(1+Math.random()))},extractParams:function(t){var n={};let k=t.split("?")[1];return void 0!==k&&k.split("&").forEach(function(t){var k=t.split("=");n[k[0]]=decodeURIComponent(k[1])}),n},appendUserIdToPath:function(t){return-1!=t.indexOf("?")?t+="&ktj_uid="+ktj.h:t+="?ktj_uid="+ktj.h,t}};module.exports=ktj;